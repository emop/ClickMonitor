*** Settings ***
Library       OperatingSystem
Library       RunRedisCommand    ${REDIES_HOST}   

*** Variables ***
${MONITOR_JAR}    ../target/ClickMonitor-1.0-SNAPSHOT.jar
${JAVA_CMD}   java
${REDIES_HOST}   127.0.0.1
${MOCK_API}    ../libs/MockTaodianApi-0.0.1.jar
${SHORT_DATA}    ../data/short_url_info.data

			
*** Keywords ***
Cleanup all alarm data
	cleanup_db_data_all
	run MockTaodianApi
	
run MockTaodianApi
    Start Process    ${JAVA_CMD} -jar ${MOCK_API} -short_data ${SHORT_DATA}

Process click log
	[Arguments]   ${click_log}   ${alarm_log}
	${rc}   ${output}   Run And Return Rc And Output	${JAVA_CMD} -jar ${MONITOR_JAR} -file ${click_log} -output ${alarm_log}
	Log   ${output}
	Should be equal as Integers   0   ${rc}
	
run ClickMoniter by log
    [Arguments]   ${click_log}
    ${rc}   ${output}   Run And Return Rc And Output	${JAVA_CMD} -jar ${MONITOR_JAR} -file ${click_log}
	Log   ${output}
	Should be equal as Integers   0   ${rc}
	
Get redis data
    [Arguments]    ${key}    ${db}
	${output}   get_data	${key}    ${db}
	
	[return]  ${output}
    